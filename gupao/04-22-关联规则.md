### 1. 关联规则
- `关联`：若两个或多个变量的取值之间存在某种规律性，称为关联
- `关联规则`：寻找在同一事件中、出现的不同项的相关性
- 对数据集的处理
  - 一个样本称为一个“`事务`”（例如，交易记录）
  - 每个事务由多个属性来确定，属性称之为“项”
  - 多个项组成的集合，称为“项集”
- `规则`：X ==> Y 含义
  - 其中
    - X和Y是项集
    - X称为规则前项
    - Y称为规则后项
  - 在将数据转换为特征向量时以用于挖掘关联规则时：
    - 往往只需要考虑该特征在样本中是否存在，如，是否购买
    - 而很少考虑数据的其他属性，如，购买的数量，商品的生产日期、重量，等等
  - `支持度`（support）
    - 定义：一个项集或规则，在所有事务中出现的频率
    - $\sigma(X)$：表示项集X的支持度计数
    - 项集X的支持度：$s(X)=\sigma(X)/N$
    - 规则X==>Y：表示物品集X和物品集Y同时出现的概率
  - `置信度`（confidence）
    - 定义：确定Y在包含X的事务中出现的频繁程度
    - $C(X->Y)=\sigma(X \bigcup Y)/\sigma(X)$
    - $p(Y|X)=p(XY)/p(X)$
      - 在置信度中，$p(Y|X)$表示X和Y要同时购买
    - 例：(X, Y)==>Z
      - 支持度：交易中，包含{X, Y, Z}的可能性
      - 置信度：包含{X, Y}的交易中，出现Z的条件概率
    - 前项和后项的调整，会导致置信度的结果不同
      - 如：X==>Y，和Y==>X，支持度相同，但置信度不同
  - 最小支持度、最小置信度
    - 设定最小支持度、最小置信度，若关联规则X==>Y的支持度和置信度都大于最小支持度和最小置信度，则称规则X==>Y为强关联规则，否则为弱关联规则
  - `提升度`：（lift）
    - 定义：物品集A的出现对物品集B的出现概率，发生了多大的变化
    - lift(A==>B) = confidence(A==>B)/support(B) = $p(B|A)/p(B)$
      - 若lift <= 1，则表示X和Y相互独立，X的出现对Y出现的可能性没有提升
      - lift越大（lift > 1），表示X对Y的提升度越大，也表明关联性越强
  - 其他指标：不是经常用到，也不常见

### 2. 关联规则在Python中的实现
- 使用`mlxtend`工具包：得出频繁项集与规则
  - pip install mlxtend
- 工具：
  - from mlxtend.frequent_patterns import apriori
  - from mlxtend.frequent_patterns import association_rules
- 步骤
  - 步骤1：构建数据集
    - 数据需转换成one-hot编码：将非数值，转换成数值编码
      - import pandas as pd
      - pd.Basket.str.join(",") # 先用","连接，
      - pd.str.get_dummies(",") # 再进行one-hot编码，以","分割
  - 步骤2：设置支持度来选择频繁项集
    - 调用apriori方法
      - min_support：一般为0.5
      - user_colnames：一般为True，通常都用列名
  - 步骤3：计算规则
    - 调用association_rules方法，指定参数
      - df：频繁项集（由第2步得出）
      - metric：指定计算规则的指标，如，支持度、置信度、提升度等
      - min_threshold：指定最小阈值
  - 步骤4：对第3步的结果进一步筛选

### 3. 总结
- 支持度一样的情况下，哪一种组合更相关？
  - 看提升度lift