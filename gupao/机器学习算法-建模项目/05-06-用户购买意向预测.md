### 0. 总结
- 工作流程
  - 1. 数据清洗与格式转换
  - 2. 探索性数据分析
  - 3. 特征工程
  - 4. 建立基础模型，尝试多种算法
  - 5. 模型调参
  - 6. 评估与测试
  - 7. 解释我们的模型
  - 8. 交上最终的试卷
- 

### 1. 项目介绍
- 购买意向
  - 基于用户历史数据
    - 看过哪些商品
    - 点了几次
    - 加了哪些购物车
    - 买了哪些东西
  - 在未来5天之内，有没有可能再买哪些东西
- 有点像推荐，但又不是，购买意向是预测
- 数据集
  - 用户数据集：JData_User.csv
  - 商品评论：JData_Comment.csv
  - 预测商品集合：JData_Product.csv
  - 用户行为数据：JData_Action.csv
- 数据初步分析
  - 已经将连续值做了离散化（相当于做了分组，指标会更明确些）
- 目的
  - 数据挖掘：找出有价值的信息
  - 把有价值的信息用在模型上

### 2. 数据挖掘流程（大纲）
- 1）数据清洗
  - 数据集完整性验证
  - 数据集是否存在缺失值
    - 对策略进行交叉验证，进行大量尝试
  - 数据集各特征值应该如何处理
  - 哪些数据是我们想要的，哪些是可以过滤掉的
  - 将有价值的数据信息做成新的数据源
    - Hadoop、spark从大数据量的数据中、提取有价值信息
  - 去掉无行为交互的商品和用户
  - 去掉浏览量很大而购买量很少的用户（惰性用户或爬虫用户）
    - 需要结合数据的业务场景来思考
- 2）数据理解与分析
  - 掌握各个特征的含义：EDA
    - 通过可视化展示，来辅助理解数据
      - 取值范围
      - 变化幅度
      - 数据的组合，是否呈现出什么样的规律
  - 观察数据有哪些特点，是否可用来建模
  - 可视化展示便于分析
  - 用户的购买意图是否随着时间等因素变化
- 3）特征提取（特征工程）
  - 基于清洗后的数据集，哪些特征是有价值的
  - 分别对用户与商品以及两者之间构成的行为进行特征提取
  - 行为因素中，哪些是核心？如何提取？
    - 参考一些资料（论文），最好是有提供源码的，以证明论文有参考价值
  - 瞬时行为特征 or 累计行为特征？
- 4）模型建立
  - 使用机器学习算法进行预测
  - 参数设置与调节
  - 数据集的切分

### 3. 数据集验证
- 目的：检查数据是不是完整的
- 首先，检查JData_User中的用户，和JData_Action中的用户是否一致
  - 保证行为数据中的行为，都是由用户数据中的用户所产生
  - 可能存在用户在行为数据中无行为
  - 也可能存在行为数据中的用户，不存在与用户数据中
  - 方法
    - import pandas as pd
    - pd.merge(data_1, data_2) # 对两个数据集按照列取交接，内连接
    - 判断原始数据跟merge后的数据数量是否一致
- 检查是否有重复记录
  - 包括：
    - 评论
    - 商品
    - 用户
    - 行为数据
      - 根据行为类型，分析重复数据的分布，决定要不要去重
  - 检查是否存在未来时间的记录：记录发生的时间，大于数据集号称的时间范围
- 数据类型转换
  - 行为数据中的user_id是浮点型，进行int类型转换
    - dataframe的`apply`方法
- 年龄区间的处理

### 4. 清洗数据
- 对什么进行清洗：用户、商品
- 建立：用户行为特征表、商品行为特征表
  - 工具包
    - from collections import Counter
  - pandas的分块读取，避免Memory Error
- 对数据进行分组，并进行统计
- 构造转化率字段
- 补充其他字段
- `保存中间结果`：把最终清洗的结果，保存为csv文件
  - 以防止哪一步出问题，数据丢失
  - 避免重复清洗
- 验证特征表的数据
  - 没有值的数据，是否真的没有行为数据
- 数据清洗
  - `统计信息`：dataframe.describe()
  - 对缺失值进行处理
    - 删除有缺失值
  - 删除无交互记录的用户
  - 删除爬虫及惰性用户
  - 保存中间数据

### 5. 数据探索
- 用户的行为轨迹
- 对数据进行可视化展示
- 周一到周日各天购买情况
  - 周一到周日，每天购买用户个数
  - 周一到周日，每天购买商品个数
  - 周一到周日，每天购买记录个数
- 一个月中， 各天购买量
  - 按每个月来统计
  - 节日、促销有影响
- 商品类别销售统计
  - 周一到周日，各商品类别销售情况
  - 每个月，各类商品的销售情况
- 查看特定用户对特定商品的行为轨迹
  - 分析购买的行为轨迹，跟没购买的行为轨迹，进行对比

### 6. 特征工程
- 机器学习中，最核心的部分
  - 需要对数据很了解
- 分两步走：特征工程与特征筛选
  - 特征工程：尽可能多的在数据中提取特征
    - 各种数值变换、特征组合、分解等，各种手段齐上阵
    - 因为特征的加工，尤其是在数据量很大的时候，是很耗时的事情。这时候，先尽可能的提取多更多的特征，作为备选，以免后续发现需要时再去找，要好得多
  - 特征筛选：找到最有价值的那些特征，作为模型的输入
    - 选择特征的过程，是反复的过程：通过各种结果来反复斟酌
- `参考论文`
  - 在做所有事情（包括对数据进行探索）之前，先找相关论文（A类以上）看一看
- 实际要做的事情
  - 选择数值特征和种类特征
  - 对这些特征，进行log变换与One-hot encoder
  - 剔除共线特征

### 7. 数据集划分
- 训练集、测试集

### 8. 建立baseline
- 在建模之前，我们得有一个最坏的打算：模型起码得有点用才行
- 衡量标准：MAE指标
  - 没有模型、用中位数来猜的话，结果是多少
    - baseline_guess = np.median(y)

### 9. 构建特征
- 读取数据文件
- 数据类型转换
  - 将int64的列，转换为float32，可以节省对内存空间的占用
- 提取特征
  - 工具方法
    - 拼接所有行为记录文件
  - 获取某个时间段的行为记录
  - 提取用户基本特征
  - 缺失值处理
    - 看有多少存在缺失值的数据，不多的话，直接drop掉
  - 独热编码处理
  - 提取商品特征，并进行数据预处理
  - 提取评论特征，并进行数据预处理
  - 构建行为特征
    - 累计行为特征

### 10. Xgboost模型
